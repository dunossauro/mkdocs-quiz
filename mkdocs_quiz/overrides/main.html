<!--
  MkDocs Quiz Plugin - Extended Main Template

  This template extends the default MkDocs Material main.html to add
  a quiz progress sidebar in the TOC sidebar and mobile view.
-->

{% extends "base.html" %}

{% block site_nav %}
  <!-- Include the original sidebar navigation -->
  {{ super() }}

  <!-- Move the quiz progress sidebar into the TOC sidebar -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Find the sidebar and TOC sidebar
      const sidebar = document.getElementById('quiz-progress-sidebar');
      const tocSidebar = document.querySelector('.md-sidebar--secondary .md-sidebar__inner');

      if (sidebar && tocSidebar && tocSidebar.firstChild) {
        // Move sidebar to the top of the TOC sidebar
        tocSidebar.insertBefore(sidebar, tocSidebar.firstChild);
      }
    });
  </script>

  <!-- Quiz progress sidebar - will be moved to TOC by script above -->
  <nav id="quiz-progress-sidebar" class="md-nav md-nav--secondary" aria-label="Quiz Progress" style="display: none;">
    <label class="md-nav__title" for="__quiz-progress">
      <span class="md-nav__icon md-icon"></span>
      Quiz Progress
    </label>
    <ul class="md-nav__list" data-md-component="quiz-progress">
      <li class="md-nav__item">
        <div class="md-nav__link">
          <span class="md-ellipsis">
            Answered: <span class="quiz-progress-answered">0</span> / <span class="quiz-progress-total">0</span> (<span class="quiz-progress-answered-percentage">0%</span>)
          </span>
        </div>
      </li>
      <li class="md-nav__item">
        <div class="md-nav__link">
          <div class="quiz-progress-bar">
            <div class="quiz-progress-bar-incorrect" style="width: 0%"></div>
            <div class="quiz-progress-bar-correct" style="width: 0%"></div>
          </div>
        </div>
      </li>
      <li class="md-nav__item">
        <div class="md-nav__link quiz-correct-reset">
          <span class="md-ellipsis">
            Correct: <span class="quiz-progress-score">0</span> / <span class="quiz-progress-score-total">0</span> (<span class="quiz-progress-score-percentage">0%</span>)
          </span>
          <a href="#" class="quiz-reset-all-link" style="color: var(--md-primary-fg-color); text-decoration: none;">
            Reset
          </a>
        </div>
      </li>
    </ul>
  </nav>
{% endblock %}

{% block tabs %}
  <!-- Mobile quiz progress tracker - appears under navbar on mobile devices -->
  <nav id="quiz-progress-mobile" class="quiz-progress-mobile md-nav" aria-label="Quiz Progress" style="display: none;">
    <ul class="md-nav__list" data-md-component="quiz-progress">
      <li class="md-nav__item">
        <div class="md-nav__link">
          <span class="md-ellipsis">
            Answered: <span class="quiz-progress-answered">0</span> / <span class="quiz-progress-total">0</span> (<span class="quiz-progress-answered-percentage">0%</span>)
          </span>
        </div>
      </li>
      <li class="md-nav__item">
        <div class="md-nav__link">
          <div class="quiz-progress-bar">
            <div class="quiz-progress-bar-incorrect" style="width: 0%"></div>
            <div class="quiz-progress-bar-correct" style="width: 0%"></div>
          </div>
        </div>
      </li>
      <li class="md-nav__item">
        <div class="md-nav__link quiz-correct-reset">
          <span class="md-ellipsis">
            Correct: <span class="quiz-progress-score">0</span> / <span class="quiz-progress-score-total">0</span> (<span class="quiz-progress-score-percentage">0%</span>)
          </span>
          <a href="#" class="quiz-reset-all-link" style="color: var(--md-primary-fg-color); text-decoration: none;">
            Reset
          </a>
        </div>
      </li>
    </ul>
  </nav>

  <!-- Include the original tabs content -->
  {{ super() }}
{% endblock %}
